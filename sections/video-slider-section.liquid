<section class="inspired-slider-section">
  <div class="container">
    <h2 class="slider-heading">{{ section.settings.heading }}</h2>    
  </div>

  <!-- Swiper Slider -->
  <div class="swiper inspired-slider" id="inspiration">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        <div class="swiper-slide inspired-slide" 
             data-product-title="{{ block.settings.product.title }}" 
             data-product-img="{{ block.settings.product.featured_image | img_url: '200x200' }}" 
             data-product-url="{{ block.settings.product.url }}">
          <div class="slide-media" data-video-url="{{ block.settings.video_url }}">
            {% if block.settings.video_url != blank %}
              <div class="video-wrapper">
                <img class="video-thumb" src="{{ block.settings.thumbnail | img_url: '600x700' }}" alt="Video Thumbnail">
                <div class="play-button">
                  <svg fill="#fff" width="80px" height="80px" viewBox="0 0 390 390">
                    <path d="M195,0C87.303,0,0,87.303,0,195c0,107.697,87.303,195,195,195c107.697,0,195-87.303,195-195C390,87.303,302.697,0,195,0z
                        M253.871,211.921l-66.328,66.326c-4.578,4.577-10.702,7.011-16.927,7.011c-3.085,0-6.189-0.594-9.152-1.82
                        c-8.94-3.704-14.774-12.431-14.774-22.106V128.669c0-9.676,5.834-18.403,14.774-22.108c8.94-3.701,19.23-1.654,26.079,5.191
                        l66.328,66.328C263.215,187.424,263.215,202.576,253.871,211.921z"/>
                  </svg>
                </div>
              </div>
            {% else %}
              <img src="{{ block.settings.image | img_url: '600x600' }}" alt="Slide Image">
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Arrows -->
    <div class="custom-prev swiper-button-prev"></div>
    <div class="custom-next swiper-button-next"></div>
  </div>

  <!-- Product Info -->
  <div class="inspired-product-info">
    <div id="inspired-proouter">
      <img id="product-img" src="" alt="">
      <p id="product-title"></p>
    </div>      
  </div>
</section>

<!-- Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<style>
.inspired-slider-section { padding: 100px 0; text-align:center; overflow:hidden; }
.inspired-slider-section .container { padding:0 20px; max-width:1740px; }
.slider-heading { font-size:40px; font-weight:700; text-align:left; margin-bottom:50px; color:#000; font-family:Frutiger Neue LT W1G; }

.inspired-slide img, .video-wrapper img { width; border-radius:12px; }

.play-button { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); cursor:pointer; opacity:0; visibility:hidden; transition:0.4s; }
.swiper-slide-active .play-button { opacity:1; visibility:visible; }
.inspired-slide {
  width: auto !important; /* Allow Swiper to control slide width */
  flex-shrink: 0;
}
.inspired-slider .swiper-wrapper {
  display: flex; /* Keep horizontal flex layout */
}
.inspired-product-info div#inspired-proouter a { display:flex; align-items:center; gap:50px; padding:18px 35px; border:1px solid #183029; border-radius:12px; background:#F5F5F5; text-decoration:none; color:#000; max-width:520px; width:98%; font-size:24px; font-weight:bold; text-align:left; }
.inspired-product-info img { width:83px; height:100%; object-fit:cover; aspect-ratio:0.9; display:block; }
.inspired-product-info #product-title { margin:0; }
.inspired-product-info #product-title a { font-size:24px; text-decoration:none; color:#000; font-weight:bold; }

.swiper-slide { transition: transform 0.4s ease, opacity 0.4s ease; transform:scale(0.95); }
.swiper-slide-active { transform:scale(1.1); z-index:2; }

.custom-prev, .custom-next { background:#fff; border:none; width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; position:absolute; top:50%; transform:translateY(-50%); cursor:pointer; z-index:10; }
.custom-prev { left:70px; }
.custom-next { right:70px; }
.custom-prev::after, .custom-next::after { display:none; }

@media(max-width: 1900px) { 
  .inspired-slider-section .container { padding:0 30px; }
  .play-button svg { width:58px; height:58px; }
  .inspired-product-info div#inspired-proouter a { gap:20px; padding:15px 20px; max-width:450px; font-size:18px; }
  .custom-prev, .custom-next{ width:36px; height:36px; }
}
@media(max-width: 1199px) { .inspired-product-info div#inspired-proouter a { max-width:360px; } }
@media(max-width: 767px) { 
  .inspired-slider-section { padding:30px 0; }
  .inspired-slider-section .container { padding:0 20px; }
  .slider-heading { font-size:24px; margin:0 0 20px; text-align:left; }
  .swiper-slide { transform:scale(1); }
  .swiper-slide-active { transform:scale(1); }
  .custom-prev { left:-13px; }
  .custom-next { right:-13px; }
  .play-button svg { width:30px; height:30px; }
}
</style>

<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const swiper = new Swiper('.inspired-slider', {
    slidesPerView: 5,
    centeredSlides: true, // center mode
    loop: true,
    spaceBetween: 30,
    autoplay: { delay: 3000 },
    navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
    breakpoints: {
      1200: { slidesPerView:6, spaceBetween: 30 },
      992: { slidesPerView: 3, spaceBetween: 20 },
      768: { slidesPerView: 1, spaceBetween: 10 }
    }
  });

  // Update Product Info
  function updateProductInfo() {
    let centerSlide = document.querySelector(".swiper-slide-active");
    if (centerSlide) {
      let title = centerSlide.getAttribute("data-product-title");
      let img = centerSlide.getAttribute("data-product-img");
      let url = centerSlide.getAttribute("data-product-url");

      document.getElementById("inspired-proouter").innerHTML = `
        <a href="${url}">
          <img id="product-img" src="${img}" alt="${title}">
          <p id="product-title">${title}</p>
        </a>
      `;
    }
  }
  swiper.on('slideChange', updateProductInfo);
  updateProductInfo();

  // Video play
  document.querySelectorAll(".slide-media").forEach(slide => {
    const btn = slide.querySelector(".play-button");
    if (btn) {
      btn.addEventListener("click", function(e) {
        e.stopPropagation();
        let url = slide.getAttribute("data-video-url");
        if (url) {
          if (url.includes("youtube") || url.includes("youtu.be")) url += (url.includes("?") ? "&" : "?") + "autoplay=1";
          else if (url.includes("vimeo")) url += (url.includes("?") ? "&" : "?") + "autoplay=1";
          slide.innerHTML = `<iframe src="${url}" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>`;
        }
      });
    }
  });
});
</script>

{% schema %}
{
  "name": "Inspired Video Slider",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Get inspired.."
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Slide Image (if no video)" },
        { "type": "image_picker", "id": "thumbnail", "label": "Video Thumbnail" },
        { "type": "url", "id": "video_url", "label": "Video URL" },
        { "type": "product", "id": "product", "label": "Linked Product" }
      ]
    }
  ],
  "presets": [
    { "name": "Inspired Video Slider", "category": "Custom" }
  ]
}
{% endschema %}
