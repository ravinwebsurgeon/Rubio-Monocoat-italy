{%  assign cat_heading = collection.metafields.custom.main_hedaing.value %}
{%  assign cat_subheading = collection.metafields.custom.main_subheading.value %}

{% assign slider_links = collection.metafields.custom.surface_urls.value %}
{% assign slider_titles = collection.metafields.custom.surface_text.value %}
{% assign slider_images = collection.metafields.custom.surface_images.value %}
{% assign surface_header = collection.metafields.custom.surface_header.value %}

  {%- for product in collection.products -%}
    {% render 'quick-cart-view', product:product %}
  {% endfor %}
<div class="custom_collection_main">

{% if cat_heading != blank %}
    <div class="collection_header_main">
      <div class="page-center">
        <div class="header_main_heading"><h2>{{ cat_heading }}</h2></div>
        <div class="header_main_subheading">{{ cat_subheading }}</div>
      </div>        
    </div>
  {% endif %}
  {% comment %} {% if slider_images != blank %}

    <div class="collection_surface_section">
        <div class="collection_surface_content">
            <div class="collection_surface_header">
                <h2>{{ surface_header }}</h2>
            </div>
            <div class="surface_inner_content">
              <div class="svg-progress">
                <svg class="Fe_H_Q" style="stroke: rgb(36, 150, 82); fill: rgb(36, 150, 82); width: 135.167px; height: 6px;"><path d="M3,3L132.16722314004244,3" stroke-linecap="butt" stroke-width="33.635856610147776" fill="none" pointer-events="auto" opacity="0" class="_682gpw" style="touch-action: pan-x pan-y pinch-zoom;"></path><g><path d="M3,3L132.16722314004244,3" stroke-linecap="round" stroke-width="6" fill="none" pointer-events="none"></path></g></svg>
                <svg class="Fe_H_Q" style="stroke: rgb(217, 217, 217); fill: rgb(217, 217, 217); width: 135.167px; height: 6px;"><path d="M3,3L132.16722314004232,3" stroke-linecap="butt" stroke-width="33.635856610147776" fill="none" pointer-events="auto" opacity="0" class="_682gpw" style="touch-action: pan-x pan-y pinch-zoom;"></path><g><path d="M3,3L132.16722314004232,3" stroke-linecap="round" stroke-width="6" fill="none" pointer-events="none"></path></g></svg>
                <svg class="Fe_H_Q" style="stroke: rgb(217, 217, 217); fill: rgb(217, 217, 217); width: 135.167px; height: 6px;"><path d="M3,3L132.16722314004232,3" stroke-linecap="butt" stroke-width="33.635856610147776" fill="none" pointer-events="auto" opacity="0" class="_682gpw" style="touch-action: pan-x pan-y pinch-zoom;"></path><g><path d="M3,3L132.16722314004232,3" stroke-linecap="round" stroke-width="6" fill="none" pointer-events="none"></path></g></svg>
                <svg class="Fe_H_Q" style="stroke: rgb(217, 217, 217); fill: rgb(217, 217, 217); width: 135.167px; height: 6px;"><path d="M3,3L132.16722314004232,3" stroke-linecap="butt" stroke-width="33.635856610147776" fill="none" pointer-events="auto" opacity="0" class="_682gpw" style="touch-action: pan-x pan-y pinch-zoom;"></path><g><path d="M3,3L132.16722314004232,3" stroke-linecap="round" stroke-width="6" fill="none" pointer-events="none"></path></g></svg>
              </div>
              <h3 class="progress_h"> What kind of floor do you have? </h3>
                {% for image in slider_images %}
                    {% assign title = slider_titles[forloop.index0] %}
                    {% assign link = slider_links[forloop.index0] %}
                    <div class="surface_slide">
                    <a href="{{ link }}" class="surface_slide_card">
                        {% if image %}
                        <div class="surface_slide_image">
                            <img src="{{ image | img_url: '600x400' }}" alt="{{ title | escape }}">
                        </div>
                        {% endif %}
                        {% if title %}
                        <p class="surface_slide_title">{{ title }}</p>
                        {% endif %}
                    </a>
                    </div>
                 {% endfor %}
            </div>
        </div>
    </div>
  {% endif %} {% endcomment %}
    </div>

    <!-- collection main-product-grid code START -->
    
{{ 'template-collection.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}

{% if section.settings.image_shape == 'blob' %}
  {{ 'mask-blobs.css' | asset_url | stylesheet_tag }}
{%- endif -%}

{%- unless section.settings.quick_add == 'none' -%}
  {{ 'quick-add.css' | asset_url | stylesheet_tag }}
{%- endunless -%}

{%- if section.settings.quick_add == 'standard' -%}
  <script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{%- if section.settings.quick_add == 'bulk' -%}
  <script src="{{ 'quick-add-bulk.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quantity-popover.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'price-per-item.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quick-order-list.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}
 {% comment %} {% for option in card_product.options_with_values %}
  {% render 'quick-cart-view', product:product %}
 {% endfor %} {% endcomment %}
<div class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}">
  {%- paginate collection.products by section.settings.products_per_page -%}
    {%- if section.settings.enable_sorting and section.settings.filter_type == 'vertical' -%}
      <facet-filters-form class="facets facets-vertical-sort page-width small-hide">
        <form class="facets-vertical-form" id="FacetSortForm">
          <div class="facet-filters sorting caption">
            <div class="facet-filters__field">
              <h2 class="facet-filters__label caption-large text-body">
                <label for="SortBy">{{ 'products.facets.sort_by_label' | t }}</label>
              </h2>
              <div class="select">
                {%- assign sort_by = collection.sort_by | default: collection.default_sort_by -%}
                <select
                  name="sort_by"
                  class="facet-filters__sort select__select caption-large"
                  id="SortBy"
                  aria-describedby="a11y-refresh-page-message"
                >
                  {%- for option in collection.sort_options -%}
                    <option
                      value="{{ option.value | escape }}"
                      {% if option.value == sort_by %}
                        selected="selected"
                      {% endif %}
                    >
                      {{ option.name | escape }}
                    </option>
                  {%- endfor -%}
                </select>
                <span class="svg-wrapper">
                  {{- 'icon-caret.svg' | inline_asset_content -}}
                </span>
              </div>
            </div>
          </div>

          <div class="product-count-vertical light" role="status">
            <h2 class="product-count__text text-body">
              <span id="ProductCountDesktop">
                {%- if collection.results_count -%}
                  {{
                    'templates.search.results_with_count'
                    | t: terms: collection.terms, count: collection.results_count
                  }}
                {%- elsif collection.products_count == collection.all_products_count -%}
                  {{ 'products.facets.product_count_simple' | t: count: collection.products_count }}
                {%- else -%}
                  {{
                    'products.facets.product_count'
                    | t: product_count: collection.products_count, count: collection.all_products_count
                  }}
                {%- endif -%}
              </span>
            </h2>
            {%- render 'loading-spinner' -%}
          </div>
        </form>
      </facet-filters-form>
    {%- endif -%}

    <div class="{% if section.settings.filter_type == 'vertical' %} facets-vertical page-width{% endif %}">
      {{ 'component-facets.css' | asset_url | stylesheet_tag }}
      <script src="{{ 'facets.js' | asset_url }}" defer="defer"></script>
      

      <div
        class="product-grid-container{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
        id="ProductGridContainer"
        {% if settings.animations_reveal_on_scroll %}
          data-cascade
        {% endif %}
      >
        {%- if collection.products.size == 0 -%}
          <div class="collection collection--empty page-width" id="product-grid" data-id="{{ section.id }}">
            <div class="loading-overlay gradient"></div>
            <div class="title-wrapper center">
              <h2 class="title title--primary">
                {{ 'sections.collection_template.empty' | t -}}
                <br>
                {{
                  'sections.collection_template.use_fewer_filters_html'
                  | t: link: collection.url, class: 'underlined-link link'
                }}
              </h2>
            </div>
          </div>
        {%- else -%}
          <div
            class="preparation-collection collection{% if section.settings.filter_type != 'vertical' %} page-width{% endif %}"
          >
            <div class="custom_collection_heading">
              <h2>All Products</h2>
              {%- if section.settings.enable_filtering or section.settings.enable_sorting -%}
              <aside
                aria-labelledby="verticalTitle"
                class="facets-wrapper{% unless section.settings.enable_filtering %} facets-wrapper--no-filters{% endunless %}{% if section.settings.filter_type != 'vertical' %} page-width{% endif %}"
                id="main-collection-filters"
                data-id="{{ section.id }}"
              >
                {% render 'facets',
                  results: collection,
                  enable_filtering: section.settings.enable_filtering,
                  enable_sorting: section.settings.enable_sorting,
                  filter_type: section.settings.filter_type,
                  paginate: paginate
                %}
              </aside>
            {%- endif -%}
            </div>
            <div class="loading-overlay gradient"></div>
            <ul
              id="product-grid"
              data-id="{{ section.id }}"
              class="
                grid product-grid grid--{{ section.settings.columns_mobile }}-col-tablet-down
                grid--{{ section.settings.columns_desktop }}-col-desktop
                {% if section.settings.quick_add == 'bulk' %} collection-quick-add-bulk{% endif %}
              "
            >
              {% assign skip_card_product_styles = false %}
              {%- for product in collection.products -%}
                {% assign lazy_load = false %}
                {%- if forloop.index > 2 -%}
                  {%- assign lazy_load = true -%}
                {%- endif -%}
                <li
                  class="grid__item{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
                  {% if settings.animations_reveal_on_scroll %}
                    data-cascade
                    style="--animation-order: {{ forloop.index }};"
                  {% endif %}
                >
                  {% render 'custom-card-product',
                    card_product: product,
                    media_aspect_ratio: section.settings.image_ratio,
                    image_shape: section.settings.image_shape,
                    show_secondary_image: section.settings.show_secondary_image,
                    show_vendor: section.settings.show_vendor,
                    show_rating: section.settings.show_rating,
                    lazy_load: lazy_load,
                    skip_styles: skip_card_product_styles,
                    quick_add: section.settings.quick_add,
                    section_id: section.id
                  %}
                
                </li>
                {%- assign skip_card_product_styles = true -%}
              {%- endfor -%}
            </ul>

            {%- if paginate.pages > 1 -%}
              {% render 'pagination', paginate: paginate, anchor: '' %}
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>
    </div>
  {%- endpaginate -%}
  {% if section.settings.image_shape == 'arch' %}
    {{ 'mask-arch.svg' | inline_asset_content }}
  {%- endif -%}
</div>

<!-- collection main-product-grid code END -->


<style>
  .custom-product-badge.product-badge {
    position: absolute;
    top: 10px;
    left: 10px;
    background-color: #183029;
    color: #fff;
    padding: 7px 10px 5px;
    line-height:1;
    font-size: 12px;
    border-radius: 4px;
    z-index: 2;
    font-family: 'Frutiger Neue LT W1G';
    font-weight:500;
}
    .custom_collection_main{
      width:100%;
    }
    .header_main_heading h2{
      color:#183029;
      font-family: 'Frutiger Neue LT W1G Cn XBlack';
      font-weight: 900;
      font-size: 32px;
      line-height: normal;
      letter-spacing: 0;
      margin: 0 0 15px;
    }
    .custom_collection_main .header_main_subheading {
      color: #183029;
      font-size: 16px;
      line-height: normal;
      font-family: 'Frutiger Neue LT W1G';
      font-weight:300;
    }
    .collection_header_main{
      background:#b9cbc5;
      padding:50px 0;
    }
    .collection_header_main .page-center {
      margin: 0 auto;
      max-width: 1760px;
      padding: 0 30px;
    }

.preparation-collection.page-width {
    max-width: 1760px;
    padding: 0 30px;
}
.preparation-collection .grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 30px;
    margin: 0;
    padding: 0;
}

.preparation-collection .grid .grid__item {
    padding: 0;
    width: 100%;
    max-width: 100%;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    transition: 0.3s;
    border: 1px solid rgba(0, 0, 0, 0.1);
}




  


.custom_card_detail{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:0 5px;}


.custom_card_detail .card__heading {
    font-size: 20px;
    font-weight: 900;
    color: #000;
    margin: 0;
    font-family: 'Frutiger Neue LT W1G Cn XBlack';
    letter-spacing: normal;
}
.custom_card_detail .price__container {
    font-size: 16px;
    font-weight: 300;
    color: #111;
    font-family: 'Frutiger Neue LT W1G';
}
.price__regular .price-item--regular {
    margin-right: 0;
    font-size: 15px;
}
.product__description.rte{
  font-weight: 300;
  font-family: 'Frutiger Neue LT W1G';
  line-height:1.2;
  letter-spacing: normal;
    font-size: 15px;
    margin: 3px 0;
}
.custom_card_detail .price__regular .price-item--regular {
    margin-right: 0;
    font-size: 18px;
    font-weight: 300;
    color: #111;
    font-family: 'Frutiger Neue LT W1G';
}

.preparation-collection .card__content .card__information {
    padding: 0;
    height: 100%;
    display: flex;
    flex-direction: column;
}
.custom_action_btns {
    margin-top: auto;
    padding-top:5px;
}
.preparation-collection .card__content {
    padding: 15px;
}

.custom_added_variants select {
    width: 100%;
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 8px;
    font-size: 13px;
    font-family: 'Frutiger Neue LT W1G';
    margin: 0 0 0;
    background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 8.5 12.5 16 5 8.5' stroke='currentColor' stroke-width='1.5' fill='none'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center right 10px;
    -webkit-appearance: none;
    appearance: none;
    background-size: 14px;
    font-weight:300;
}
.custom_added_variants select:focus{
  box-shadow:none;
  outline:none;
}
.pro_variant_options.variant__Size:after {
    content: "";
    position: absolute;
    right: 34px;
    width: 1px;
    height: 20px;
    background-color: #ccc;
    top: 5px;
}
.pro_variant_options {
    margin: 15px 0;
    position: relative;
}
.meta__detail-ctg{
    display: flex;
    gap: 10px;
    margin: 6px 0 2px;
    flex-wrap: wrap;
}
.meeta-fl {
    display: flex;
    align-items: center;
    gap: 5px;
    background-color: #fff;
    border-radius: 20px;
    border: 1px solid #ddd;
    padding: 6px 10px;
    font-size: 13px;
    font-family: Frutiger Neue LT W1G;
    font-weight: 300;
    letter-spacing: normal;
    line-height: 1;
    color: #000;
}
.meeta-fl img {
    display: block;
    height: 15px;
    object-fit: contain;
}
.meeta-fl .immmg {
    width: 15px;
}

.meeta-fl .immmg img {
    display: block;
    height: 15px;
    object-fit: contain;
}

.meeta-fl .mememe {
    line-height: 1;
    font-family: 'Frutiger Neue LT W1G';
    font-weight:300;
}






.product_actions_btns button {
    border: none;
    padding: 11px 12px 8px;
    border-radius: 33px;
    font-size: 14px;
    cursor: pointer;
    font-family: 'Frutiger Neue LT W1G';
    font-weight:500;
    flex: auto;
    color: #000;
}
button.show-more-swatches {
    font-family: 'Frutiger Neue LT W1G';
    font-weight: 300;
    color: #183029;
    padding: 0;
    border: none;
    background-color: transparent;
    outline: none;
    font-size:12.5px;
}
.product_actions_btns {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin-top: auto;
    flex-wrap:wrap;
}
.product_actions_btns > a {
  flex: auto;
}
.product_actions_btns button.product_link_btn {
    background: #183029;
    color: #fff;
    width:100%;
}
.product_actions_btns button.product_cart_btn {
    background: #f7c600;
}
.preparation-collection .grid .grid__item .card {
    background-color: #f2f2f2;
    --ratio-percent: inherit !important;
}
.preparation-collection .grid .grid__item .card .card__inner.ratio {
    --ratio-percent: inherit !important;
    aspect-ratio: 1.4;
}

.preparation-collection .grid .grid__item .card .card__media {
    background: #f2f2f2;
    object-fit: cover;
    border-radius: 10px 10px 0 0;
    z-index:1;
}

.custom_collection_heading h2 {
    letter-spacing: normal;
    font-family: 'Frutiger Neue LT W1G Cn XBlack';
    font-weight: 900;
    font-size: 22px;
    margin: 0;
    color:#000;
}
.custom_collection_heading {
    display: flex;
    align-items: center;
    margin:0 0 20px;
    flex-wrap:wrap;
}
.custom_collection_heading .facet-filters {
  padding-left: 0;
}
.custom_collection_heading aside {
    padding: 0;
    max-width: 100%;
    margin: 0 0 0 auto;
}

.custom_collection_heading aside h2 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
}

.custom_collection_heading aside .facets__wrapper {
    gap: 10px;
    align-items: center;
    font-family: Frutiger Neue LT W1G;
}

.custom_collection_heading aside .facets__wrapper .facets__summary {
    margin: 0;
    font-size: 14px;
}
.custom_collection_heading .facets__summary .icon-caret {
    filter: invert(1);
}
.custom_collection_heading aside .facets__wrapper .facets__summary:hover span.facets__summary-label{
   text-decoration:none;
}
.custom_collection_heading .facet-filters__field {
    gap: 10px;
    font-size: 14px;
    font-family: Frutiger Neue LT W1G;
}
.custom_collection_heading .facets__form .product-count {
      opacity: 1;
  }
.custom_collection_heading .facet-filters__field select{
  font-size: 14px;
    font-family: Frutiger Neue LT W1G;
}
.custom_collection_heading .facet-filters__field select:focus{
   box-shadow:none;
   outline:none;
}


.preparation-collection .color-swatch {
    overflow: inherit;
    border:none;
}
.preparation-collection .color-swatch{
  width: 20px;
  height: 20px;
}
.preparation-collection .swatch-checkmark {
    outline: 1px solid rgb(214, 245, 224);
    outline-offset: 2px;
    display: block;
    width: 20px;
    height: 20px;
    border-radius: 100%;
    border: 1px solid #f2f2f2;
}
.preparation-collection .swatch-checkmark::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: transparent;
}
.preparation-collection .color-swatch-input:checked + .swatch-checkmark{
  outline: 1px solid  #396948;
}
.pro_variant_options .color-swatch-group {
    margin-top: 0;
    gap: 10px;
}

.preparation-collection .color-swatch-input:checked + .swatch-checkmark::after {
    content: "";
    inset: inherit;
    width: 12px;
    height: 12px;
    background-color: #396948;
    background-image: url(data:image/png;base64,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);
    background-size: 5px 5px;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 100%;
    position: absolute;
    top: -5px;
    z-index: 1;
    border: none;
    right: -5px;
    box-shadow: none;
}

.klaviyo-star-rating-widget svg {
      width: 18px !important;
      height: 18px !important;
  }

@media (max-width: 1279px) {
  .preparation-collection .grid {
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
  }
}
@media (max-width: 1023px) {
  .preparation-collection .grid {
      grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 989px) {
  .custom_collection_heading facet-filters-form.facets.small-hide {
      display: none;
  }
}

@media (max-width: 991px) {
  .preparation-collection.page-width {
    padding: 0 20px;
  }
 
  .collection_header_main {
    padding: 30px 0;
  }
  .header_main_heading h2 {
      margin: 0 0 10px;
      font-size:24px;
  }
   .custom_collection_heading .facets-container {
    padding-top: 0;
    gap: 0 1rem;
  }
}

@media (max-width: 767px) {
.preparation-collection .grid {
    grid-template-columns: repeat(2, 1fr);
    gap:10px;
  }
  .preparation-collection .card__content {
      padding: 12px 10px;
  }
 
  .custom_collection_heading h2 {
    font-size: 16px;
  }
  .custom_collection_heading aside h2 {
    font-size: 13px;
  }
  .custom_card_detail .card__heading {
      font-size: 18px;
  }
  .product__description.rte {
    font-size: 13px;
    margin: 3px 0 5px;
    letter-spacing: normal;
  }
  .klaviyo-star-rating-widget svg {
      width: 13px !important;
      height: 13px !important;
  }
  .price .price-item {
      font-size: 14px;
      letter-spacing: normal;
  }
  .kl_reviews__star_rating_widget__label {
      line-height: normal;
      letter-spacing: normal;
      font-size: 12px !important;
  }
  .preparation-collection .grid .grid__item .card .card__inner.ratio {   
    aspect-ratio: 1.3;
  }
  button.show-more-swatches{
    font-size:11.5px;
  }
  .meeta-fl .mememe {
      font-size: 12px;
  }
  .meeta-fl {
    padding: 5px 8px;
  }
  .product_actions_btns {
      gap: 5px;
  }
  .custom_action_btns {
      padding-top: 0;
  }
  .custom_added_variants select{
    color:#000;
  }
}
    
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () { 
      document.querySelectorAll(".product_cart_btn").forEach(btn => { 
      btn.addEventListener("click", async e => {
        e.preventDefault();
        let productHandle = btn.dataset.productHandle
        const response = await fetch(`/products/${productHandle}.js`);
        const product = await response.json();
	      openCustomCart(productHandle,product) 
               
      });
    }); 

    function openCustomCart(handle,product){
      let customCarts = document.querySelectorAll('.quick__cart__main')
      customCarts.forEach(function(my_cart) {
        let my_handle = my_cart.dataset.productHandle;
        if(my_handle == handle){
          let pro_variants = product.variants;
          let id = my_cart.querySelector(".variant-selector");
          
          my_cart.classList.add('active__Cart')
           updateVariantId(my_cart, pro_variants, id);
          const allImages = my_cart.querySelectorAll(".product__image__item.first__visit");
          {% comment %} allImages[0].style.display = "block"; {% endcomment %}
          allImages.forEach(img => {
          img.classList.remove("first__visit");
});
          {% comment %} const response = await fetch(`/products/${handle}.js`);
          const product = await response.json();
          const variants = product.variants;
          const variantIdInput = my_cart.querySelector(".variant-selector");
          updateVariantId(my_cart, variants, variantIdInput); {% endcomment %}
          
        }
        else{
          my_cart.classList.remove('active__Cart')
        }
      })
          
    }
    document.querySelectorAll(".quick__cart__close").forEach(btn => {
      btn.addEventListener("click", e => {
          let cart = btn.closest(".quick__cart__main");
          cart.classList.remove("active__Cart");
              // RESET QTY TO 1
        const qtyInput = cart.querySelector(".quick-cart-qty-input");
        const minusBtn = cart.querySelector(".qty-minus");
        const plusBtn = cart.querySelector(".qty-plus");

        if (qtyInput) {
          qtyInput.value = 1;
          minusBtn.classList.add("disabled__btn");
          plusBtn.classList.remove("disabled__btn");
        }
      });
    });

    document.querySelectorAll('.ajax__cart').forEach(function (button) {
        button.addEventListener('click', function () {
            const productBlock = button.closest('.quick__cart__main');
            const variantSelect = productBlock.querySelector('.variant-selector');
            const qtyInput = productBlock.querySelector('.quick-cart-qty-input');
            let  selected_quantity = parseInt(qtyInput.value) || 1;
            const variantId = variantSelect.value;
            const variantIdInt = parseInt(variantSelect.value, 10)
             const productJsonEl = productBlock.querySelector(".quick-product-json");
             if(productJsonEl){
             const productData = JSON.parse(productJsonEl.textContent);
            const variants = productData.variants;
            const selectedVariant = variants.find(v => v.id === variantIdInt);
            console.log(selectedVariant.inventory_quantity,'selectedVariant Data') 
            const maxStock = selectedVariant.inventory_quantity;
              if (selected_quantity > maxStock) {
                  selected_quantity = maxStock;
              }
            }
            fetch('/cart/add.js', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({
                    id: variantId,
                    quantity: selected_quantity
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Added to cart3:', data);
                updateCartCount(1);
                refreshCartDrawer();
            })
            .catch(error => {
                console.error('Error adding to cart:', error);
                alert("Something went wrong.");
            });
        });
    }); 
});


function updateCartCount(totalQuantityAdded) {
    const cartCounts = document.querySelectorAll('.cart-count-bubble > span');
    const customCount = document.querySelector('.custom-cart-count-bubble > span');

    if (cartCounts.length > 0) {
        // Update all cart bubbles (standard or custom)
        cartCounts.forEach(count => {
            const currentNumber = Number(count.textContent) || 0;
            const newNumber = currentNumber + totalQuantityAdded;
            count.textContent = newNumber;
            count.parentNode.style.display = 'block';
            count.parentNode.style.visibility = 'visible';
        });
    } else if (customCount) {
        // Update existing custom bubble
        let number = Number(customCount.textContent) || 0;
        customCount.textContent = number + totalQuantityAdded;
        customCount.parentNode.style.display = 'block';
        customCount.parentNode.style.visibility = 'visible';
    } else {
        // Create new bubble if none exists
        const mainCartBubble = document.querySelector('.header__icon--cart');
        if (mainCartBubble) {
            const newCount = document.createElement('div');
            newCount.classList.add('custom-cart-count-bubble','cart-count-bubble');

            const newCountSpan = document.createElement('span');
            newCountSpan.textContent = totalQuantityAdded;

            newCount.appendChild(newCountSpan);
            mainCartBubble.appendChild(newCount);
            newCount.style.display = "block";
            newCount.style.visibility = "visible";
        }
    }
}


function refreshCartDrawer() {
  const cartDrawer = document.querySelector('cart-drawer');

  fetch(`${routes.cart_url}?sections=cart-drawer`)
    .then(response => response.json())
    .then(sections => {
      const newCartDrawerHtml = sections['cart-drawer'];
      const newDocument = new DOMParser().parseFromString(newCartDrawerHtml, 'text/html');
      const newCartDrawer = newDocument.querySelector('cart-drawer');

      if (cartDrawer && newCartDrawer) {
        cartDrawer.replaceWith(newCartDrawer);
        document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', { bubbles: true }));
        newCartDrawer.classList.add('active', 'animate');
      }
    })
    .catch((error) => { console.error('Error refreshing cart drawer:', error); });
}
{% comment %} 
document.addEventListener("DOMContentLoaded", function() {
  const productCards = document.querySelectorAll(".card__information");
  productCards.forEach(card => {
    const selects = card.querySelectorAll(".option-variant-selector");
    const variantInput = card.querySelector(".variant-selector");
    const productJSON = card.querySelector(".product-json");
    console.log(productJSON,'productJSON')
    if (!productJSON) return;

    const productData = JSON.parse(productJSON.textContent);

    function updateVariantId() {
      const selectedOptions = Array.from(selects).map(s => s.value);
      const matchedVariant = productData.variants.find(v =>
        v.options.every((opt, idx) => opt === selectedOptions[idx])
      );

      if (matchedVariant) {
        variantInput.value = matchedVariant.id;
        console.log(`✅ Updated variant for ${productData.title}:`, matchedVariant.id);
      } else {
        console.warn(`⚠️ No matching variant found for ${productData.title}`);
      }
    }

    selects.forEach(select => select.addEventListener("change", updateVariantId));
  });
}); {% endcomment %}
</script>

<script>
  //update select variant id in quick cart view
  document.addEventListener("DOMContentLoaded", () => {
  const quickCarts = document.querySelectorAll('.quick__cart__main');
  quickCarts.forEach(async (cart) => {
    const productHandle = cart.getAttribute('data-product-handle');
    if (!productHandle) return;
    // Load product variant data
    const response = await fetch(`/products/${productHandle}.js`);
    const product = await response.json();
    const variants = product.variants;
    const variantIdInput = cart.querySelector(".variant-selector");
    updateVariantId(cart, variants, variantIdInput);
    // Listen for changes on *all radios* inside this cart
    const variantInputs = cart.querySelectorAll(".color-swatch-input, .variant-radio-input");
    variantInputs.forEach(input => {
      input.addEventListener("change", () => {
        updateVariantId(cart, variants, variantIdInput);
      });
    });

  });
});
function updateVariantId(cart, variants, variantIdInput) {
  const selectedOptions = [];
  const optionGroups = cart.querySelectorAll("[data-index^='option']");

  // Loop through each option group
  optionGroups.forEach(group => {
    const selectedRadio = group.querySelector("input[type='radio']:checked");
    // Find the corresponding .option__value span
    const optionValueSpan = group.closest('.product_variant_main')?.querySelector('.option__value');

    if (selectedRadio) {
      selectedOptions.push(selectedRadio.dataset.value);

      // Update the .option__value span dynamically
      if (optionValueSpan) {
        optionValueSpan.textContent = selectedRadio.dataset.value;
      }
    }
  });

  // Find matching variant
  const foundVariant = variants.find(v => {
    return v.options.every((opt, idx) => opt === selectedOptions[idx]);
  });

  const priceElement = cart.querySelector(".product__price");

  if (foundVariant) {
    // Update hidden variant ID input
    variantIdInput.value = foundVariant.id;
    console.log("Variant matched:", foundVariant.id, foundVariant);

    // Update product images
    const allImages = cart.querySelectorAll(".product__image__item");
     {% comment %} const allMedia = cart.querySelectorAll(".product__image__item, .product__video__item"); {% endcomment %}

    let matchedImage = null;
    let firstEmptyAltImage = null;
    // Hide all images first
    allImages.forEach(img => img.style.display = "none");
    // Find matching image based on selected options
    allImages.forEach(img => {
        {% comment %} const alt = img.parentElement.dataset.alt || ""; {% endcomment %}
      {% comment %} const altParts = img.alt.split('/').map(p => p.trim().toLowerCase()); {% endcomment %}
        const alt = (img.alt || "").trim(); // Ensure no whitespace issues
        const altParts = alt ? alt.split('/').map(p => p.trim().toLowerCase()) : [];
      let isMatch = true;
      for (let i = 0; i < selectedOptions.length; i++) {
        if (normalizeValue(selectedOptions[i]) !== normalizeValue(altParts[i])) {
          isMatch = false;
          break;
        }
      }
      if (isMatch) matchedImage = img;
      else if (!alt && !firstEmptyAltImage) {firstEmptyAltImage = img;}
    });

    // Show matched image or fallback to first image
    if (matchedImage) {
      matchedImage.style.display = "block";
    } 
    else if (firstEmptyAltImage) {
    firstEmptyAltImage.style.display = "block";
    }
    else if (allImages.length > 0) {
      allImages[0].style.display = "block";
    }

    // Update price dynamically
    if (priceElement) {
      priceElement.textContent = formatPrice(foundVariant.price);
    }

  } else {
    console.warn("No variant matches:", selectedOptions);
  }
}

// Helper functions
function formatPrice(amount) {
  const currency = Shopify.currency.active;
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: currency
  }).format(amount / 100);
}

function normalizeValue(str) {
  if (!str) return "";
  return str
    ? str.toString()
         .trim()
         .toLowerCase()
         .replace(/\s+/g, '')
         .replace(/\./g, '-')
         .replace(/[^a-z0-9-]/g, '')
    : '';
}

document.querySelectorAll('.product__qty__wrapper').forEach(wrapper => {
    const minusBtn = wrapper.querySelector('.qty-minus');
    const plusBtn = wrapper.querySelector('.qty-plus');
    const qtyInput = wrapper.querySelector('.quick-cart-qty-input');

    const min = parseInt(qtyInput.min) || 1;
    const max = parseInt(qtyInput.max) || 99;

    function updateButtons() {
        let value = parseInt(qtyInput.value);

        // Disable minus at min
        if (value <= min) {
            minusBtn.classList.add("disabled__btn");
        } else {
            minusBtn.classList.remove("disabled__btn");
        }

        // Disable plus at max
        if (value >= max) {
            plusBtn.classList.add("disabled__btn");
        } else {
            plusBtn.classList.remove("disabled__btn");
        }
    }

    minusBtn.addEventListener("click", () => {
        if (!minusBtn.classList.contains("disabled__btn")) {
            qtyInput.value = Math.max(min, parseInt(qtyInput.value) - 1);
            updateButtons();
        }
    });

    plusBtn.addEventListener("click", () => {
        if (!plusBtn.classList.contains("disabled__btn")) {
            qtyInput.value = Math.min(max, parseInt(qtyInput.value) + 1);
            updateButtons();
        }
    });

    qtyInput.addEventListener("input", () => {
        let value = parseInt(qtyInput.value);

        if (isNaN(value) || value < min) qtyInput.value = min;
        if (value > max) qtyInput.value = max;

        updateButtons();
    });

    // Initial state
    updateButtons();
});
</script>


{% schema %}
{
  "name": "t:sections.main-collection-product-grid.name",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 8,
      "max": 36,
      "step": 4,
      "default": 16,
      "label": "t:sections.main-collection-product-grid.settings.products_per_page.label"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "t:sections.main-collection-product-grid.settings.columns_desktop.label"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "default": "2",
      "label": "t:sections.main-collection-product-grid.settings.columns_mobile.label",
      "options": [
        {
          "value": "1",
          "label": "t:sections.main-collection-product-grid.settings.columns_mobile.options__1.label"
        },
        {
          "value": "2",
          "label": "t:sections.main-collection-product-grid.settings.columns_mobile.options__2.label"
        }
      ]
    },    
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "info": "t:sections.all.colors.has_cards_info",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.main-collection-product-grid.settings.header__3.content"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__1.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__2.label"
        },
        {
          "value": "square",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__3.label"
        }
      ],
      "default": "adapt",
      "label": "t:sections.main-collection-product-grid.settings.image_ratio.label"
    },
    {
      "type": "select",
      "id": "image_shape",
      "options": [
        {
          "value": "default",
          "label": "t:sections.all.image_shape.options__1.label"
        },
        {
          "value": "arch",
          "label": "t:sections.all.image_shape.options__2.label"
        },
        {
          "value": "blob",
          "label": "t:sections.all.image_shape.options__3.label"
        },
        {
          "value": "chevronleft",
          "label": "t:sections.all.image_shape.options__4.label"
        },
        {
          "value": "chevronright",
          "label": "t:sections.all.image_shape.options__5.label"
        },
        {
          "value": "diamond",
          "label": "t:sections.all.image_shape.options__6.label"
        },
        {
          "value": "parallelogram",
          "label": "t:sections.all.image_shape.options__7.label"
        },
        {
          "value": "round",
          "label": "t:sections.all.image_shape.options__8.label"
        }
      ],
      "default": "default",
      "label": "t:sections.all.image_shape.label"
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_secondary_image.label"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_vendor.label"
    },
    {
      "type": "checkbox",
      "id": "show_rating",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_rating.label",
      "info": "t:sections.main-collection-product-grid.settings.show_rating.info"
    },
    {
      "type": "select",
      "id": "quick_add",
      "default": "none",
      "label": "t:sections.main-collection-product-grid.settings.quick_add.label",
      "options": [
        {
          "value": "none",
          "label": "t:sections.main-collection-product-grid.settings.quick_add.options.option_1"
        },
        {
          "value": "standard",
          "label": "t:sections.main-collection-product-grid.settings.quick_add.options.option_2"
        },
        {
          "value": "bulk",
          "label": "t:sections.main-collection-product-grid.settings.quick_add.options.option_3"
        }
      ]
    },
    {
      "type": "header",
      "content": "t:sections.main-collection-product-grid.settings.header__1.content"
    },
    {
      "type": "checkbox",
      "id": "enable_filtering",
      "default": true,
      "label": "t:sections.main-collection-product-grid.settings.enable_filtering.label",
      "info": "t:sections.main-collection-product-grid.settings.enable_filtering.info"
    },
    {
      "type": "select",
      "id": "filter_type",
      "options": [
        {
          "value": "horizontal",
          "label": "t:sections.main-collection-product-grid.settings.filter_type.options__1.label"
        },
        {
          "value": "vertical",
          "label": "t:sections.main-collection-product-grid.settings.filter_type.options__2.label"
        },
        {
          "value": "drawer",
          "label": "t:sections.main-collection-product-grid.settings.filter_type.options__3.label"
        }
      ],
      "default": "horizontal",
      "label": "t:sections.main-collection-product-grid.settings.filter_type.label"
    },
    {
      "type": "checkbox",
      "id": "enable_sorting",
      "default": true,
      "label": "t:sections.main-collection-product-grid.settings.enable_sorting.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ],
  "blocks":[
    {
      "type": "@app"
    },
  ]
}
{% endschema %}
