<div class="cust-project">
  <div class="page-width">
    <div class="cust-pro-wrap">
      <h3 class="heading-pr">{{ section.settings.heading }}</h3>

      <div class="main-pro-wrap">
        <!-- Interior / Exterior -->
        <div class="pro-first">
          <div class="Interio">
            {% if section.settings.img1 %}
              <img src="{{ section.settings.img1 | img_url: 'master' }}" alt="Interior">
            {% endif %}
            <div class="inter-btn" id="interior">Interior</div>
          </div>
          <div class="exterior">
            {% if section.settings.img2 %}
              <img src="{{ section.settings.img2 | img_url: 'master' }}" alt="Exterior">
            {% endif %}
            <div class="exter-btn" id="exterior">Exterior</div>
          </div>
        </div>

        <!-- Tabs + Products -->
        <div class="circle-tabs-section">
          {% if section.settings.heading2 != blank %}
            <h3 class="tabs-heading heading-pr">{{ section.settings.heading2 }}</h3>
          {% endif %}

          <!-- Circle Tabs -->
          <div class="circle-tabs">
            {% for block in section.blocks %}
              <button class="circle-tab{% if forloop.first %} active{% endif %}" data-tab="tab-{{ block.id }}">
                {% if block.settings.tab_image %}
                  <img src="{{ block.settings.tab_image | img_url: '200x200' }}" alt="{{ block.settings.tab_name | escape }}">
                {% endif %}
                <span>{{ block.settings.tab_name }}</span>
              </button>
            {% endfor %}
          </div>

          <!-- Filter bar -->
          <div class="filter-bar">
            <div class="filter-left">
              <button class="icon-btn color-ic"><i>üé®</i></button>
              <button class="icon-btn img-ic"><i>üñºÔ∏è</i></button>
              <button class="icon-btn filter">
                <i>‚öôÔ∏è</i><span>Filter by</span>
              </button>
            </div>

            <button class="tips-link" id="openVideo">
              <span class="play">‚ñ∂</span>
              Not sure which colour to choose? Check out our expert tips!
            </button>
          </div>

          <!-- Video modal -->
          <div class="video-modal" id="videoModal">
            <div class="modal-content">
              <button class="close" id="closeVideo">√ó</button>
              <video id="expertVideo" autoplay muted loop playsinline class="video-bg">
                <source src="{{ section.settings.video_url }}" type="video/mp4">
              </video>
            </div>
          </div>

          <h4 class="oil-head">Oil Plus 2C - Interior wood oil</h4>

          {% for block in section.blocks %}
            {% assign tab_collection = block.settings.tab_collection %}
            <div class="tab-products{% if forloop.first %} active{% endif %}" id="tab-{{ block.id }}">
              <ul class="product-grid">
                {% for product in tab_collection.products %}
                  <li class="product-item">
                    <a href="{{ product.url }}">
                      {% if product.featured_image %}
                        <div class="product-image-wrapper"
                             data-cover="{{ product.metafields.custom.cover_image | img_url: 'master' }}"
                             data-featured="{{ product.featured_image | img_url: '400x' }}">
                          {% if product.metafields.custom.cover_image != blank %}
                            <img class="cover-image"
                                 src="{{ product.metafields.custom.cover_image | img_url: 'master' }}"
                                 alt="{{ product.title }}">
                          {% endif %}
                          <img class="featured-image"
                               src="{{ product.featured_image | img_url: '400x' }}"
                               alt="{{ product.title | escape }}">
                        </div>
                      {% endif %}

                      <h3>{{ product.title }}</h3>
                      <p class="price">{{ product.price | money }}</p>

                      <!-- ‚úÖ colour_filter2 metafield -->
                      {% if product.metafields.custom.colour_filter2 %}
                        <ul class="colour-filter-list">
                          {% for value in product.metafields.custom.colour_filter2 %}
                            <li>{{ value }}</li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Project",
  "settings": [
    { "type": "text", "id": "heading", "label": "Main Heading", "default": "Choose your project:" },
    { "type": "image_picker", "id": "img1", "label": "Interior Image" },
    { "type": "image_picker", "id": "img2", "label": "Exterior Image" },
    { "type": "text", "id": "heading2", "label": "Secondary Heading", "default": "Choose your species:" },
    { "type": "url", "id": "video_url", "label": "Video URL (MP4)" }
  ],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        { "type": "text", "id": "tab_name", "label": "Tab name" },
        { "type": "image_picker", "id": "tab_image", "label": "Tab image" },
        { "type": "collection", "id": "tab_collection", "label": "Collection to show" }
      ]
    }
  ],
  "presets": [{ "name": "Project", "category": "Custom" }]
}
{% endschema %}

<script>
document.addEventListener('DOMContentLoaded', function () {
  /* circle tabs */
  document.querySelectorAll('.circle-tab').forEach(btn => {
    btn.addEventListener('click', function () {
      document.querySelectorAll('.circle-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-products').forEach(c => c.classList.remove('active'));
      this.classList.add('active');
      document.getElementById(this.dataset.tab).classList.add('active');
    });
  });

  /* video modal */
  const openBtn = document.getElementById('openVideo'),
        modal = document.getElementById('videoModal'),
        closeBtn = document.getElementById('closeVideo'),
        video = document.getElementById('expertVideo');

  if (openBtn && modal && closeBtn && video) {
    openBtn.addEventListener('click', () => {
      modal.classList.add('active');
      video.currentTime = 0;
      video.play();
    });
    closeBtn.addEventListener('click', () => {
      modal.classList.remove('active');
      video.pause();
    });
    modal.addEventListener('click', e => {
      if (e.target === modal) {
        modal.classList.remove('active');
        video.pause();
      }
    });
  }
});
</script>

<style>
/* ‚Ä¶ keep your existing CSS styles ‚Ä¶ */
.colour-filter-list {
  margin-top: 8px;
  padding: 0;
  list-style: none;
  display: flex;
  gap: 6px;
}
.colour-filter-list li {
  background:#eee;
  padding:4px 8px;
  border-radius:4px;
  font-size:14px;
}
</style>
