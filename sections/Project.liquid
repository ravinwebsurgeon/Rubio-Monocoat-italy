<div class="cust-project">
  <div class="page-width">
    <div class="cust-pro-wrap">
      <h3 class="heading-pr">{{ section.settings.heading }}</h3>

      <div class="main-pro-wrap">
        <!-- Interior / Exterior Images -->
        <div class="pro-first">
          <div class="Interio">
            {% if section.settings.img1 %}
              <img src="{{ section.settings.img1 | img_url: 'master' }}" alt="Interior">
            {% endif %}
            <div class="inter-btn" id="interior">Interior</div>
          </div>

          <div class="exterior">
            {% if section.settings.img2 %}
              <img src="{{ section.settings.img2 | img_url: 'master' }}" alt="Exterior">
            {% endif %}
            <div class="exter-btn" id="exterior">Exterior</div>
          </div>
        </div>

        <!-- Tabs + Products -->
        <div class="pro-second">
          <h3 class="heading-pr">{{ section.settings.heading2 }}</h3>
          <div class="main-tabs">

            {% assign tab_names = section.blocks | map: 'settings' | map: 'tab_group' | compact | uniq %}

            <!-- Tabs -->
            <ul class="tabs">
              {% for t in tab_names %}
                <li data-tab="menu{{ forloop.index }}">{{ t }}</li>
              {% endfor %}
            </ul>

            <!-- Tab Contents -->
            {% for t in tab_names %}
              <div class="tab-content" id="menu{{ forloop.index }}">
                <ul class="collection-list">
                  {% for b in section.blocks %}
                    {% if b.settings.tab_group == t and b.settings.col %}
                      {% assign the_collection = b.settings.col %}
                      {% for product in the_collection.products %}
                        <li>
                          <a href="{{ product.url }}">
                            <div class="tabbing-all-data">
                              <div class="img-col">
                                {% if product.featured_image %}
                                  <img src="{{ product.featured_image | img_url: '400x' }}" alt="{{ product.title | escape }}">
                                {% endif %}
                              </div>
                              <h3>{{ product.title }}</h3>
                              <p>{{ product.price | money }}</p>
                            </div>
                          </a>
                        </li>
                      {% endfor %}
                    {% endif %}
                  {% endfor %}
                </ul>
              </div>
            {% endfor %}

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Project",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Main Heading",
      "default": "Choose your project:"
    },
    {
      "type": "image_picker",
      "id": "img1",
      "label": "Interior Image"
    },
    {
      "type": "image_picker",
      "id": "img2",
      "label": "Exterior Image"
    },
    {
      "type": "text",
      "id": "heading2",
      "label": "Secondary Heading",
      "default": "Choose your species:"
    }
  ],
  "blocks": [
    {
      "type": "collection_item",
      "name": "Collection Item",
      "settings": [
        {
          "type": "text",
          "id": "tab_group",
          "label": "Tab Name (group)",
          "info": "Collections with the same Tab Name appear in the same tab."
        },
        {
          "type": "collection",
          "id": "col",
          "label": "Choose Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Project",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<script>
document.addEventListener('DOMContentLoaded', function(){
  // set first tab active
  const firstTab = document.querySelector('.tabs li');
  const firstContent = document.querySelector('.tab-content');
  if (firstTab && firstContent) {
    firstTab.classList.add('active');
    firstContent.classList.add('active');
  }

  // tab click handler
  document.querySelectorAll('.tabs li').forEach(function(tab){
    tab.addEventListener('click', function(){
      const id = this.dataset.tab;
      document.querySelectorAll('.tabs li, .tab-content').forEach(el => el.classList.remove('active'));
      this.classList.add('active');
      document.getElementById(id).classList.add('active');
    });
  });
});
</script>

<style>
.pro-first {
  display: flex;
  width: 100%;
  gap: 50px;
}

.Interio,
.exterior {
  width: 50%;
  display: flex;
  flex-direction: column;
  gap: 20px;
  justify-content: center;
  align-items: center;
}

.Interio img,
.exterior img {
  width: 100%;
}

.inter-btn,
.exter-btn {
  border-radius: 50px;
  border: 1px solid #000;
  padding: 13px 37px;
  text-align: center;
  width: 160px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

h3.heading-pr {
  text-align: center;
  font-size: 40px;
  font-weight: 700;
}

.pro-second {
  background-color: #F5F5F5;
  border-radius: 20px;
  padding: 20px;
}

.tabs {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
  gap: 20px;
  list-style: none;
  padding: 0;
}

.tabs li {
  cursor: pointer;
  padding: 10px 20px;
  border: 1px solid #000;
  border-radius: 20px;
}

.tabs li.active {
  background-color: #000;
  color: #fff;
}

.tab-content { display: none; }
.tab-content.active { display: block; }
.collection-list {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  list-style: none;
  padding: 0;
}
.collection-list li {
  width: 200px;
}
.collection-list img {
  width: 100%;
  border-radius: 10px;
}
</style>
