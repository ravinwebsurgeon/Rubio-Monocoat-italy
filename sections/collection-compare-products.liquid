{% assign products = collection.metafields.custom.compare_products.value %}
{% assign heading = collection.metafields.custom.compare_products_heading.value %}
{% assign des_headings = collection.metafields.custom.compare_product_des_heading.value %}
{% assign des_purpose_raw = collection.metafields.custom.compare_product_des_purpose.value %}
{% assign des_suitable_raw = collection.metafields.custom.compare_product_des_suitable.value %}
{% assign des_benefits_raw = collection.metafields.custom.compare_product_des_benefits.value %}
{% assign des_moment_raw = collection.metafields.custom.compare_product_des_moment.value %}


<div class="comapre_products_section">
    <div class="compare_products_data">
        <div class="compare_products_heading">
            <h2>{{ heading }}</h2>
        </div>
        <div class="compare_products">
            {% for product in products %}
                <div class="product_data">
                    <div class="product_media_content">
                        <a href="{{ product.url }}">
                            <img src="{{ product.featured_image | img_url: "small" }}" />
                        </a>
                    </div>
                    <div class="product_title">
                        <p>{{ product.title }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    {% comment %} <div class="products_description_conent">
        <div class="heading_lists">
            {% for text in des_headings %}
                <div class="des_content">
                    <h2>{{ text }}</h2>
                </div>
            {% endfor %}
        </div>
    </div> {% endcomment %}
{% if des_purpose_raw[0] != nil %}
  {% assign des_purpose = des_purpose_raw %}
{% else %}
  {% assign des_purpose = des_purpose_raw | split: ',' %}
{% endif %}

{% if des_suitable_raw[0] != nil %}
  {% assign des_suitable = des_suitable_raw %}
{% else %}
  {% assign des_suitable = des_suitable_raw | split: ',' %}
{% endif %}

{% if des_benefits_raw[0] != nil %}
  {% assign des_benefits = des_benefits_raw %}
{% else %}
  {% assign des_benefits = des_benefits_raw | split: ',' %}
{% endif %}

{% if des_moment_raw[0] != nil %}
  {% assign des_moment = des_moment_raw %}
{% else %}
  {% assign des_moment = des_moment_raw | split: ',' %}
{% endif %}

{% assign max_rows = des_purpose.size %}
{% if des_suitable.size > max_rows %}
  {% assign max_rows = des_suitable.size %}
{% endif %}
{% if des_benefits.size > max_rows %}
  {% assign max_rows = des_benefits.size %}
{% endif %}
{% if des_moment.size > max_rows %}
  {% assign max_rows = des_moment.size %}
{% endif %}

<div class="compare-table-wrapper">
  <table class="compare-table">
    <thead>
      <tr>
        {% for heading in des_headings %}
          <th>{{ heading }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for i in (0..max_rows-1) %}
        <tr>
          <td>{{ des_purpose[i] | strip }}</td>
          <td>{{ des_suitable[i] | strip }}</td>
          <td>{{ des_benefits[i] | strip }}</td>
          <td>{{ des_moment[i] | strip }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>



</div>
<style>
    .compare_products{display:flex;}
{% comment %} .compare-table-wrapper {
  overflow-x: auto;
  margin-top: 30px;
}

.compare-table {
  width: 100%;
  border-collapse: collapse;
  font-family: inherit;
  text-align: left;
}

.compare-table th {
  font-weight: 600;
  padding: 14px 10px;
  background-color: #f9f9f9;
  border-bottom: 2px solid #ddd;
}

.compare-table td {
  padding: 14px 10px;
  border-bottom: 1px solid #eee;
  vertical-align: top;
}

.compare-table tr:last-child td {
  border-bottom: none;
}

@media (max-width: 768px) {
  .compare-table th, .compare-table td {
    padding: 10px;
    font-size: 14px;
  }
} {% endcomment %}

</style>

{% schema %}
{
  "name": "Compare Product Section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Section Heading", "default": "Latest from the blog" },
  ],
  "presets": [
    { "name": "Compare Product Section", "category": "collection" }
  ]
}
{% endschema %}