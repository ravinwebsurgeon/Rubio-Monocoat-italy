{% assign products = collection.metafields.custom.compare_products.value %}
{% assign heading = collection.metafields.custom.compare_products_heading.value %}
{% assign des_headings = collection.metafields.custom.compare_product_des_heading.value %}
{% assign des_purpose = collection.metafields.custom.compare_product_des_purpose.value %}
{% assign des_suitable = collection.metafields.custom.compare_product_des_suitable.value %}
{% assign des_benefits = collection.metafields.custom.compare_product_des_benefits.value %}
{% assign des_moment = collection.metafields.custom.compare_product_des_moment.value %}


<div class="comapre_products_section">
    <div class="compare_products_data">
        <div class="compare_products_heading">
            <h2>{{ heading }}</h2>
        </div>
        <div class="compare_products">
            {% for product in products %}
                <div class="product_data">
                    <div class="product_media_content">
                        <a href="{{ product.url }}">
                            <img src="{{ product.featured_image | img_url: "small" }}" />
                        </a>
                    </div>
                    <div class="product_title">
                        <p>{{ product.title }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    {% comment %} <div class="products_description_conent">
        <div class="heading_lists">
            {% for text in des_headings %}
                <div class="des_content">
                    <h2>{{ text }}</h2>
                </div>
            {% endfor %}
        </div>
    </div> {% endcomment %}
    {%- assign sep_candidates = ",|||\n|;" | split: "|" -%} 

{%- capture normalize_array %}
  {% raw %}
  {% assign __raw = __INPUT__ %}
  {% if __raw[0] != nil %}
    {% assign __arr = __raw %}
  {% else %}
    {% comment %} try '||' (common custom separator) {% endcomment %}
    {% if __raw contains '||' %}
      {% assign __arr = __raw | split: '||' %}
    {% elsif __raw contains '\n' %}
      {% assign __arr = __raw | split: '\n' %}
    {% elsif __raw contains ',' %}
      {% assign __arr = __raw | split: ',' %}
    {% elsif __raw contains ';' %}
      {% assign __arr = __raw | split: ';' %}
    {% else %}
      {% assign __arr = __raw | split: '|' %}
    {% endif %}
  {% endif %}
  {% for __x in __arr %}
    {{- '__ITEM__' -}}
  {% endfor %}
  {% endraw %}
{% endcapture %}

{% if raw_purpose[0] != nil %}
  {% assign arr_purpose = raw_purpose %}
{% else %}
  {% if raw_purpose contains '||' %}
    {% assign arr_purpose = raw_purpose | split: '||' %}
  {% elsif raw_purpose contains '\n' %}
    {% assign arr_purpose = raw_purpose | split: '\n' %}
  {% elsif raw_purpose contains ',' %}
    {% assign arr_purpose = raw_purpose | split: ',' %}
  {% elsif raw_purpose contains ';' %}
    {% assign arr_purpose = raw_purpose | split: ';' %}
  {% else %}
    {% assign arr_purpose = raw_purpose | split: '|' %}
  {% endif %}
{% endif %}


{% if raw_suitable[0] != nil %}
  {% assign arr_suitable = raw_suitable %}
{% else %}
  {% if raw_suitable contains '||' %}
    {% assign arr_suitable = raw_suitable | split: '||' %}
  {% elsif raw_suitable contains '\n' %}
    {% assign arr_suitable = raw_suitable | split: '\n' %}
  {% elsif raw_suitable contains ',' %}
    {% assign arr_suitable = raw_suitable | split: ',' %}
  {% elsif raw_suitable contains ';' %}
    {% assign arr_suitable = raw_suitable | split: ';' %}
  {% else %}
    {% assign arr_suitable = raw_suitable | split: '|' %}
  {% endif %}
{% endif %}


{% if raw_benefits[0] != nil %}
  {% assign arr_benefits = raw_benefits %}
{% else %}
  {% if raw_benefits contains '||' %}
    {% assign arr_benefits = raw_benefits | split: '||' %}
  {% elsif raw_benefits contains '\n' %}
    {% assign arr_benefits = raw_benefits | split: '\n' %}
  {% elsif raw_benefits contains ',' %}
    {% assign arr_benefits = raw_benefits | split: ',' %}
  {% elsif raw_benefits contains ';' %}
    {% assign arr_benefits = raw_benefits | split: ';' %}
  {% else %}
    {% assign arr_benefits = raw_benefits | split: '|' %}
  {% endif %}
{% endif %}


{% if raw_moment[0] != nil %}
  {% assign arr_moment = raw_moment %}
{% else %}
  {% if raw_moment contains '||' %}
    {% assign arr_moment = raw_moment | split: '||' %}
  {% elsif raw_moment contains '\n' %}
    {% assign arr_moment = raw_moment | split: '\n' %}
  {% elsif raw_moment contains ',' %}
    {% assign arr_moment = raw_moment | split: ',' %}
  {% elsif raw_moment contains ';' %}
    {% assign arr_moment = raw_moment | split: ';' %}
  {% else %}
    {% assign arr_moment = raw_moment | split: '|' %}
  {% endif %}
{% endif %}


{% if raw_headings[0] != nil %}
  {% assign arr_headings = raw_headings %}
{% else %}
  {% if raw_headings contains '||' %}
    {% assign arr_headings = raw_headings | split: '||' %}
  {% elsif raw_headings contains '\n' %}
    {% assign arr_headings = raw_headings | split: '\n' %}
  {% elsif raw_headings contains ',' %}
    {% assign arr_headings = raw_headings | split: ',' %}
  {% elsif raw_headings contains ';' %}
    {% assign arr_headings = raw_headings | split: ';' %}
  {% else %}
    {% assign arr_headings = raw_headings | split: '|' %}
  {% endif %}
{% endif %}


{% assign max_rows = 0 %}
{% if arr_purpose.size > max_rows %}{% assign max_rows = arr_purpose.size %}{% endif %}
{% if arr_suitable.size > max_rows %}{% assign max_rows = arr_suitable.size %}{% endif %}
{% if arr_benefits.size > max_rows %}{% assign max_rows = arr_benefits.size %}{% endif %}
{% if arr_moment.size > max_rows %}{% assign max_rows = arr_moment.size %}{% endif %}



<div class="compare-table-wrapper">
  <table class="compare-table">
    <thead>
      <tr>
        {% for h in arr_headings %}
          <th>{{ h | strip }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for i in (0..max_rows-1) %}
        <tr>
          <td>{{ arr_purpose[i]  | default: '' | strip }}</td>
          <td>{{ arr_suitable[i] | default: '' | strip }}</td>
          <td>{{ arr_benefits[i] | default: '' | strip }}</td>
          <td>{{ arr_moment[i]   | default: '' | strip }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</div>
<style>
    .compare_products{display:flex;}
{% comment %} .compare-table-wrapper {
  overflow-x: auto;
  margin-top: 30px;
}

.compare-table {
  width: 100%;
  border-collapse: collapse;
  font-family: inherit;
  text-align: left;
}

.compare-table th {
  font-weight: 600;
  padding: 14px 10px;
  background-color: #f9f9f9;
  border-bottom: 2px solid #ddd;
}

.compare-table td {
  padding: 14px 10px;
  border-bottom: 1px solid #eee;
  vertical-align: top;
}

.compare-table tr:last-child td {
  border-bottom: none;
}

@media (max-width: 768px) {
  .compare-table th, .compare-table td {
    padding: 10px;
    font-size: 14px;
  }
} {% endcomment %}

</style>

{% schema %}
{
  "name": "Compare Product Section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Section Heading", "default": "Latest from the blog" },
  ],
  "presets": [
    { "name": "Compare Product Section", "category": "collection" }
  ]
}
{% endschema %}