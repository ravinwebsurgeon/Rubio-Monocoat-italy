{% if section.settings.section_heading %}
<div class="best-sellers-section">
  <h2>{{ section.settings.section_heading }}</h2>
  <div class="products-grid">
    {% assign all_products = collections.all.products %}
    {% assign sorted_products = all_products | sort: 'best_selling' %}
     <ul
        id="product-grid"
        data-id="{{ section.id }}"
        class="
        grid product-grid grid--{{ section.settings.columns_mobile }}-col-tablet-down
        grid--{{ section.settings.columns_desktop }}-col-desktop
        {% if section.settings.quick_add == 'bulk' %} collection-quick-add-bulk{% endif %}
        "
     >
    {% for product in sorted_products limit: section.settings.products_limit %}
      <div class="product-card">
        {% comment %} <a href="{{ product.url }}"> {% endcomment %}
            {% if product.featured_image %}
            <div class="best_selling_product___media">
            {{ product.featured_image | image_url: width: 400 | image_tag }}
            </div>
          {% endif %}
          <div class="best_selling_product__detail">
            <h3>{{ product.title }}</h3>
            <p>{{ product.price | money }}</p>
          </div>
          <div class="best_selling__variants">
            {% assign max_to_show = 5 %}
            {% for option in product.options_with_values %}
              {% assign total_values = option.values | size %}
              <div class="pro_variant_options variant__{{ option.name }}">
                {% assign downcase_name = option.name | downcase %}
                {% if downcase_name contains 'color' or downcase_name contains 'colour' %}
                  <div class="color-swatch-group" data-index="option{{ forloop.index }}">
                    {% for value in option.values %}
                      {% if forloop.index <= max_to_show %}
                        {% assign swatch_value = '' %}
                        {% assign swatch_focal = '' %}
                        {% if value.swatch %}
                          {% if value.swatch.image %}
                            {% assign img_url = value.swatch.image | image_url: width: 50 %}
                            {% assign swatch_value = 'url(' | append: img_url | append: ')' %}
                            {% assign swatch_focal = value.swatch.image.presentation.focal_point %}
                          {% elsif value.swatch.color %}
                            {% assign swatch_value = 'rgb(' | append: value.swatch.color.rgb | append: ')' %}
                          {% endif %}
                        {% endif %}                        
                        {% if swatch_value == '' %}
                          {% assign swatch_value = value | downcase %}
                        {% endif %}
                        <label
                          class="color-swatch"
                          title="{{ value }}"
                          style="background: {{ swatch_value }};{% if swatch_focal != '' %} background-position: {{ swatch_focal }};{% endif %}"
                        >
                          <input
                            type="radio"
                            name="option-color-{{ forloop.parentloop.index0 }}"
                            value="{{ value | escape }}"
                            {% if option.selected_value == value %}checked{% endif %}
                            class="color-swatch-input"
                            data-value="{{ value | escape }}"
                          >
                          <span class="swatch-checkmark"></span>
                        </label>
                      {% endif %}
                    {% endfor %}
                    {% if total_values > max_to_show %}
                      <button class="show-more-swatches"
                              data-count="{{ total_values | minus: max_to_show }}">
                        +{{ total_values | minus: max_to_show }} more
                      </button>
                    {% endif %}
                  </div>
                {% else %}
                  <select class="option-variant-selector"
                          id="ProductSelect-{{ forloop.index0 }}"
                          data-index="option{{ forloop.index }}">
                    {% for value in option.values %}
                      {% if forloop.index <= max_to_show %}
                        <option
                          value="{{ value | escape }}"
                          {% if option.selected_value == value %} selected="selected"{% endif %}
                        >
                          {{ value | escape }}
                        </option>
                      {% endif %}
                    {% endfor %}
                  </select>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        {% comment %} </a> {% endcomment %}
      </div>
       {% comment %} <li class="grid__item">
            {% render 'custom-card-product',
            card_product: product,
            %}
        </li> {% endcomment %}
    {% endfor %}
    </ul>
  </div>
</div>
{% endif %}
<style>
    .best_selling_products__home .custom_action_btns ,
    .best_selling_products__home .card__badge{display:none;} 
</style>
{% schema %}
{
  "name": "Best Sellers Section",
  "class": "best_selling_products__home",
  "settings": [
    {
      "type": "number",
      "id": "products_limit",
      "label": "Number of products to show",
      "default": 8,
    },
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section Heading",
    }
  ],
  "presets": [
    {
      "name": "Best Sellers",
      "category": "Products"
    }
  ]
}
{% endschema %}