{% if section.settings.section_heading %}
<div class="best-sellers-section">
  <div class="page-width">
    <div class="best-sellers-heds">
      <h2>{{ section.settings.section_heading }}</h2>
      {% if section.settings.btn_text  %}
       <a href="{{ section.settings.btn_link }}" class="best_selling_btn"> {{ section.settings.btn_text }} </a>
      {%endif %}
    </div>
    
    <div class="products__grid">
      {% assign all_products = collections.all.products %}
      {% assign sorted_products = all_products | sort: 'best_selling' %}
      <div class="best__selling__main"
          {% comment %} data-id="{{ section.id }}"
          class="
          grid product-grid grid--{{ section.settings.columns_mobile }}-col-tablet-down
          grid--{{ section.settings.columns_desktop }}-col-desktop
          {% if section.settings.quick_add == 'bulk' %} collection-quick-add-bulk{% endif %} 
          " {% endcomment %}
          id="best__selling__products"
      >
      {% for product in sorted_products limit: section.settings.products_limit %}
        <div class="best_selling__product__card">
          {% comment %} <a href="{{ product.url }}"> {% endcomment %}
              {% if product.featured_image %}
              <div class="best_selling_product___media">
              {% comment %} {{ product.featured_image | image_url: width: 400 | image_tag }} {% endcomment %}
              <a href="{{ product.url }}">
                <img src="{{ product.featured_image | img_url: 'medium' }}" />
              </a>
              </div>
            {% endif %}
            <div class="best_selling-boxesss">
              <div class="best_selling_product__detail">
                <h3>{{ product.title }}</h3>
                <p>{{ product.price | money }}</p>
              </div>
              <div class="best_selling__variants">
              {% assign max_to_show = 5 %}
              {% for option in product.options_with_values %}
                {% assign total_values = option.values | size %}
                <div class="pro_variant_options variant__{{ option.name }}">
                  {% assign downcase_name = option.name | downcase %}
                  {% if downcase_name contains 'color' or downcase_name contains 'colour' %}
                    <div class="color-swatch-group" data-index="option{{ forloop.index }}">
                      {% for value in option.values %}
                        {% if forloop.index <= max_to_show %}
                          {% assign swatch_value = '' %}
                          {% assign swatch_focal = '' %}
                          {% if value.swatch %}
                            {% if value.swatch.image %}
                              {% assign img_url = value.swatch.image | image_url: width: 50 %}
                              {% assign swatch_value = 'url(' | append: img_url | append: ')' %}
                              {% assign swatch_focal = value.swatch.image.presentation.focal_point %}
                            {% elsif value.swatch.color %}
                              {% assign swatch_value = 'rgb(' | append: value.swatch.color.rgb | append: ')' %}
                            {% endif %}
                          {% endif %}                        
                          {% if swatch_value == '' %}
                            {% assign swatch_value = value | downcase %}
                          {% endif %}
                          <label
                            class="color-swatch"
                            title="{{ value }}"
                            style="background: {{ swatch_value }};{% if swatch_focal != '' %} background-position: {{ swatch_focal }};{% endif %}"
                          >
                            <input
                              type="radio"
                              name="option-color-{{ forloop.parentloop.index0 }}"
                              value="{{ value | escape }}"
                              {% if option.selected_value == value %}checked{% endif %}
                              class="color-swatch-input"
                              data-value="{{ value | escape }}"
                            >
                            <span class="swatch-checkmark"></span>
                          </label>
                        {% endif %}
                      {% endfor %}
                      {% if total_values > max_to_show %}
                        <button class="show-more-swatches"
                                data-count="{{ total_values | minus: max_to_show }}">
                          +{{ total_values | minus: max_to_show }} more
                        </button>
                      {% endif %}
                    </div>
                  {% else %}
                    <select class="option-variant-selector"
                            id="ProductSelect-{{ forloop.index0 }}"
                            data-index="option{{ forloop.index }}">
                      {% for value in option.values %}
                        {% if forloop.index <= max_to_show %}
                          <option
                            value="{{ value | escape }}"
                            {% if option.selected_value == value %} selected="selected"{% endif %}
                          >
                            {{ value | escape }}
                          </option>
                        {% endif %}
                      {% endfor %}
                    </select>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
            </div> 
        </div>
      {% endfor %}
    </div>
    </div>
  </div>  
</div>
{% endif %}
<style>
    .best_selling_products__home .custom_action_btns ,
    .best_selling_products__home .card__badge{display:none;} 
</style>
<script>
  document.addEventListener("DOMContentLoaded", function () {
   $('#best__selling__products').slick({
      slidesToShow: 4,
      slidesToScroll: 1,
      infinite: true,
      dots: false,
      arrows: true,
      centerMode: false,
      adaptiveHeight: true,
      {% comment %} prevArrow: '<button type="button" class="slick-prev custom-prev">&lt;</button>',
      nextArrow: '<button type="button" class="slick-next custom-next">&gt;</button>', {% endcomment %}
       prevArrow: `
    <button type="button" class="slick-prev custom-prev">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24">
        <path d="M471.1 297.4C483.6 309.9 483.6 330.2 471.1 342.7L279.1 534.7C266.6 547.2 246.3 547.2 233.8 534.7C221.3 522.2 221.3 501.9 233.8 489.4L403.2 320L233.9 150.6C221.4 138.1 221.4 117.8 233.9 105.3C246.4 92.8 266.7 92.8 279.2 105.3L471.2 297.3z"/>
      </svg>
    </button>
  `,
  nextArrow: `
    <button type="button" class="slick-next custom-next">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24">
        <path d="M168.9 297.4C156.4 309.9 156.4 330.2 168.9 342.7L360.9 534.7C373.4 547.2 393.7 547.2 406.2 534.7C418.7 522.2 418.7 501.9 406.2 489.4L236.8 320L406.1 150.6C418.6 138.1 418.6 117.8 406.1 105.3C393.6 92.8 373.3 92.8 360.8 105.3L168.8 297.3z"/>
      </svg>
    </button>
  `,
      responsive: [
        {
          breakpoint: 1024,
          settings: { slidesToShow: 3 }
        },
        {
          breakpoint: 768,
          settings: { slidesToShow: 2 }
        },
        {
          breakpoint: 767,
          settings: { slidesToShow: 1, dots: true,
      arrows: false, }
        }
      ]
    });
    

  });
</script> 

{% schema %}
{
  "name": "Best Sellers Section",
  "class": "best_selling_products__home",
  "settings": [
    {
      "type": "number",
      "id": "products_limit",
      "label": "Number of products to show",
      "default": 8,
    },
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section Heading",
    },
    {
      "type": "text",
      "id": "btn_text",
      "label": "Button Text",
    },
    {
      "type": "url",
      "id": "btn_link",
      "label": "Button Link",
    }
  ],
  "presets": [
    {
      "name": "Best Sellers",
      "category": "Products"
    }
  ]
}
{% endschema %}