{% comment %}
  Section: How To Use FAQ
  Image (left) + Accordion FAQ (right)
  Metafields:
    - custom.how_to_use_faq_image
    - custom.how_to_use_faq_question
    - custom.how_to_use_faq_answer
{% endcomment %}

<div class="custom-faq-wrapper">
  <div class="custom-faq-inner">
    <!-- Left Image -->
    <div class="custom-faq-image">
      {% if product.metafields.custom.how_to_use_faq_image %}
        <img src="{{ product.metafields.custom.how_to_use_faq_image | img_url: '800x' }}" alt="How to use" loading="lazy">
      {% endif %}
    </div>

    <!-- Right FAQ Accordion -->
    <div class="custom-faq-section">
      {% assign faq_questions = product.metafields.custom.how_to_use_faq_question.value %}
      {% assign faq_answers = product.metafields.custom.how_to_use_faq_answer.value %}

      {% if faq_questions and faq_answers %}
        {% for question in faq_questions %}
          {% assign answer = faq_answers[forloop.index0] %}
          <div class="custom-faq-item {% if forloop.first %}active{% endif %}">
            <button type="button" class="custom-faq-question">
              {{ question }}
              <span class="custom-faq-icon">+</span>
            </button>
            <div class="custom-faq-answer">
              <p>{{ answer }}</p>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</div>


<style>
    
  .custom-faq-wrapper {
      max-width: 1745px;
    margin: 0 auto;
    padding: 0 30px;
  }
  .custom-faq-inner {
    display: flex;
    gap: 40px;
    align-items: center;
  }
  .custom-faq-image img {
    max-width: 100%;
    border-radius: 12px;
  }
  .custom-faq-section {
    flex: 1;
  }
  .custom-faq-item {
    border-bottom: 1px solid #fff;
    padding: 10px 0;
  }
  .custom-faq-question {
    width: 100%;
    text-align: left;
    font-weight: bold;
    background: none;
    border: none;
    cursor: pointer;
    padding: 10px 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color:#fff;
  }
  .custom-faq-icon {
    transition: transform 0.3s ease;
  }
  .custom-faq-item.active .custom-faq-icon {
    transform: rotate(45deg);
  }
  .custom-faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    color:#fff;
  }
  .custom-faq-item.active .custom-faq-answer {
    max-height: 500px; /* adjust for longer answers */
    margin-top: 10px;
  }

  /* Responsive */
  @media(max-width: 768px) {
    .custom-faq-inner {
      flex-direction: column;
    }
  }
</style>

<script>
$(".custom-faq-item").on("click", ".custom-faq-question, .custom-faq-icon", function () {
    // Always target the .custom-faq-question
    var $header = $(this).closest(".custom-faq-question");
    var $content = $header.next(".custom-faq-answer");

    // Toggle content
    $content.slideToggle();
    $header.toggleClass("open");
});
</script>
