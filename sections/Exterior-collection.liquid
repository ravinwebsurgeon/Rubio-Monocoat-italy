<div class="tab-products-wrap">
  <h4 class="oil-head">{{ section.settings.heading }}</h4>
  
  {% for block in section.blocks %}
    {% assign tab_collection = block.settings.tab_collection %}
    
    <div class="tab-productss {% if forloop.first %}active{% endif %}">
      <!-- Add dynamic class to <ul> -->
      <ul class="product-grid grid-{{ forloop.index0 }} collection-{{ tab_collection.handle }}">
        
        {% for product in tab_collection.products %}
          <li class="product-item"
              data-colours="{{ product.metafields.custom.colour_filter2.value | join: ',' }}"
              data-products="{{ product.metafields.custom.product_filter.value | join: ',' }}"
              data-available="{{ product.available }}"
              data-product-id="{{ product.variants.first.id }}">                        
              
            <div class="product-item-img-col">
              <a href="{{ product.url }}">
                {% if product.featured_image %}
                  <div class="product-image-wrapper" 
                       data-cover="{{ product.metafields.custom.cover_image | img_url: 'master' }}" 
                       data-featured="{{ product.featured_image | img_url: '400x' }}">
                    {% if product.metafields.custom.cover_image != blank %}
                      <img class="cover-image" src="{{ product.metafields.custom.cover_image | img_url: ' ' }}" alt="{{ product.title }}">
                    {% endif %}
                    <img class="featured-image" src="{{ product.featured_image | img_url: ' ' }}" alt="{{ product.title | escape }}">
                  </div>
                {% endif %}
              </a>
              <div class="plus-show">{% render 'Cs-plus-icon' %}</div>
            </div>
            
            <div class="product-item-conts">
              <div class="product-buttons-wraper">
                <button class="more-info-color">More Info</button>
                <button class="order-sample-color">Order Sample</button>                  
              </div>
              <a href="{{ product.url }}">
                <h3>{{ product.title }}</h3>
                <p class="price hidden">{{ product.price | money }}</p>    
              </a>                         
            </div>
          </li>                      
        {% endfor %}
      </ul>
    </div>
  {% endfor %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const surfaceItems = document.querySelectorAll('.surface-item');
  const grids = document.querySelectorAll('.product-grid');

  // Hide all grids initially
  grids.forEach(grid => grid.style.display = 'none');

  surfaceItems.forEach(item => {
    item.addEventListener('click', function() {
      // Remove active class from all surface buttons
      surfaceItems.forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');

      const targetCollection = this.dataset.collection;

      // Hide all grids
      grids.forEach(grid => grid.style.display = 'none');

      // Show the correct grid by matching collection handle
      const targetGrid = document.querySelector('.collection-' + targetCollection);
      if(targetGrid) {
        targetGrid.style.display = 'block';
      }
    });
  });

  // Optional: show horizontal surface by default
  const defaultSurface = document.querySelector('.surface-item.horizontal');
  if(defaultSurface) defaultSurface.click();
});
</script>

{% schema %}
{
  "name": "Exterior-collection",
  "settings": [
    { "type": "text", "id": "heading", "label": "Main Heading" }
    
  ],
  "blocks": [
    {
      "type": "Exterior-collection",
      "name": "collection",
      "settings": [
       
        { "type": "collection", "id": "tab_collection", "label": "Collection to show" }
      ]
    }
  ],
  "presets": [{ "name": "Exterior-collection", "category": "Custom" }]
}
{% endschema %}