<div class="fullscreen-modal-main">
    <div class="fullscreen-modal">
        <img class="fs-img fs-media" />
        <video class="fs-video fs-media" controls playsinline></video>
    </div>
    <button class="close-fullscreen">×</button>
</div>

<script>
 document.addEventListener("DOMContentLoaded", function () {

    const modal = document.querySelector('.fullscreen-modal');
    const modalImg = document.querySelector('.fs-img');
    const modalVideo = document.querySelector('.fs-video');
    const closeBtn = document.querySelector('.close-fullscreen');

    const thumbnailImages = [...document.querySelectorAll('.thumbnail-item img')].filter(img => !img.closest('video'));
    const thumbnailVideos = [...document.querySelectorAll('.thumbnail-item video')];
    const mainImages = [...document.querySelectorAll('.main-image-item img')].filter(img => !img.closest('video'));
    const mainVideos = [...document.querySelectorAll('.main-image-item video')];

    const allMedia = [
        ...thumbnailImages,
        ...thumbnailVideos,
        ...mainImages,
        ...mainVideos
    ];

    // ----------------------------------------------------------
    // OPEN — SMOOTH VERSION
    // ----------------------------------------------------------
    allMedia.forEach(el => {
        el.addEventListener('click', async () => {

            // Reset
            modalImg.classList.remove("show");
            modalVideo.classList.remove("show");

            modalImg.style.display = "none";
            modalVideo.style.display = "none";
            modalVideo.pause();
            modalVideo.src = "";

            // Step 1 — Open modal background ONLY
            modal.classList.add("active");

            // Wait for fade-in
            await new Promise(r => setTimeout(r, 120));

            // Step 2 — Now show media inside smoothly
            if (el.tagName.toLowerCase() === "video") {
                const source = el.querySelector("source").src;

                modalVideo.src = source;
                modalVideo.style.display = "block";

                // Allow it to appear after layout
                requestAnimationFrame(() => {
                    modalVideo.classList.add("show");
                    modalVideo.play();
                });

            } else {
                modalImg.src = el.src;
                modalImg.style.display = "block";

                requestAnimationFrame(() => {
                    modalImg.classList.add("show");
                });
            }

        });
    });

    // ----------------------------------------------------------
    // CLOSE
    // ----------------------------------------------------------
    function closeModal() {

        modal.classList.remove("active");

        modalImg.classList.remove("show");
        modalVideo.classList.remove("show");

        setTimeout(() => {
            modalVideo.pause();
            modalVideo.src = "";
        }, 350);
    }

    closeBtn.addEventListener("click", closeModal);

    modal.addEventListener("click", e => {
        if (e.target === modal) closeModal();
    });
});

</script>

<style>
    
/* Modal background fade */
.fullscreen-modal {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;

    background: rgba(0,0,0,0.85);
    display: flex;
    justify-content: center;
    align-items: center;

    opacity: 0;
    visibility: hidden;
    pointer-events: none;

    transition: opacity .35s ease, visibility .35s ease;
    z-index: 9999999;
}

.fullscreen-modal.active {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

/* Media starts invisible, fades later */
.fs-media {
    max-width: 90vw;
    max-height: 90vh;
    opacity: 0;
    transform: scale(.85);
    transition: opacity .25s ease, transform .25s ease;
}

.fs-media.show {
    opacity: 1;
    transform: scale(1);
}

/* Close button */
.close-fullscreen {
    position: fixed;
    top: 20px;
    right: 25px;
    font-size: 40px;
    color: #fff;
    background: none;
    border: none;
    cursor: pointer;
    z-index: 10000000;
}
</style>