<div class="fullscreen-modal-main">
    <div class="fullscreen-modal">
        <img class="fs-img" src="" alt="">
        <video class="fs-video" controls playsinline></video>
    </div>
    <button class="close-fullscreen">×</button>
</div>

<script>
 document.addEventListener("DOMContentLoaded", function () {
    const modal = document.querySelector('.fullscreen-modal');
    const modalImg = document.querySelector('.fs-img');
    const modalVideo = document.querySelector('.fs-video');
    const closeBtn = document.querySelector('.close-fullscreen');

    // Collect IMAGE and VIDEO media:
    const thumbnailImages = [...document.querySelectorAll('.thumbnail-item img')].filter(img => !img.closest('video'));
    const thumbnailVideos = [...document.querySelectorAll('.thumbnail-item video')];
    const mainImages = [...document.querySelectorAll('.main-image-item img')].filter(img => !img.closest('video'));
    const mainVideos = [...document.querySelectorAll('.main-image-item video')];

    const allMedia = [
        ...thumbnailImages,
        ...thumbnailVideos,
        ...mainImages,
        ...mainVideos
    ];

    // -------------------------------------------------------
    // SMOOTH OPEN
    // -------------------------------------------------------
    allMedia.forEach(el => {
        el.addEventListener('click', async () => {

            // Hide media first (so it animates)
            modalImg.style.display = "none";
            modalVideo.style.display = "none";
            modalVideo.pause();
            modalVideo.src = ""; // avoid video loading jump

            // Activate modal background only first
            modal.classList.add("active");

            // Wait 1 frame → allows fade to begin
            await new Promise(requestAnimationFrame);

            if (el.tagName.toLowerCase() === "video") {

                const source = el.querySelector('source').src;
                modalVideo.src = source;
                modalVideo.style.display = "block";

                // Wait 1 frame → allows smooth scale animation
                await new Promise(requestAnimationFrame);

                modalVideo.play();

            } else {

                modalImg.src = el.src;
                modalImg.style.display = "block";

                // Wait 1 frame → smooth scale animation
                await new Promise(requestAnimationFrame);
            }
        });
    });

    // -------------------------------------------------------
    // SMOOTH CLOSE
    // -------------------------------------------------------
    function closeModal() {
        modal.classList.add("closing");
        modal.classList.remove("active");

        setTimeout(() => {
            modalVideo.pause();
            modalVideo.src = "";
            modal.classList.remove("closing");
        }, 350);
    }

    closeBtn.addEventListener("click", closeModal);

    modal.addEventListener("click", e => {
        if (e.target === modal) closeModal();
    });
});

</script>

<style>
.fullscreen-modal {
    position: fixed; 
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.85);
    display: flex;
    justify-content: center;
    align-items: center;

    opacity: 0;
    visibility: hidden;
    pointer-events: none;

    z-index: 9999999;
    transition: opacity .35s ease, visibility .35s ease;
}

.fullscreen-modal.active {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

.fullscreen-modal img,
.fullscreen-modal video {
    max-width: 90vw;
    max-height: 90vh;
    transform: scale(.7);
    opacity: 0;
    transition: transform .35s ease, opacity .35s ease;
}

/* MEDIA visible and animated */
.fullscreen-modal.active img,
.fullscreen-modal.active video {
    transform: scale(1);
    opacity: 1;
}

/* Closing animation */
.fullscreen-modal.closing img,
.fullscreen-modal.closing video {
    transform: scale(.6);
    opacity: 0;
}

/* Close button */
.close-fullscreen {
    position: fixed;
    top: 20px;
    right: 25px;
    font-size: 40px;
    color: #fff;
    background: none;
    border: none;
    cursor: pointer;
    z-index: 10000000;
}

</style>